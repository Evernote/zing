# -*- coding: utf-8 -*-
#
# Copyright (C) Pootle contributors.
# Copyright (C) Zing contributors.
#
# This file is a part of the Zing project. It is distributed under the GPL3
# or later license. See the LICENSE file for a copy of the license and the
# AUTHORS file for copyright and authorship information.

from django.utils.translation import gettext as _

from pootle_misc.checks import check_names


def get_filter_name(GET):
    """Gets current filter's human-readable name.

    :param GET: A copy of ``request.GET``.
    :return: Two-tuple with the filter name, and a list of extra arguments
        passed to the current filter.
    """
    filter = extra = None

    if "filter" in GET:
        filter = GET["filter"]

        if filter.startswith("user-"):
            extra = [GET.get("user", _("User missing"))]
        elif filter == "checks" and "checks" in GET:
            extra = [
                check_names.get(check, check) for check in GET["checks"].split(",")
            ]
    elif "search" in GET:
        filter = "search"

        extra = [GET["search"]]
        if "sfields" in GET:
            extra.extend(GET["sfields"].split(","))

    filter_name = {
        "all": _("All"),
        "translated": _("Translated"),
        "untranslated": _("Untranslated"),
        "fuzzy": _("Needs work"),
        "incomplete": _("Incomplete"),
        # Translators: This is the name of a filter
        "search": _("Search"),
        "checks": _("Checks"),
        "my-submissions": _("My submissions"),
        "user-submissions": _("Submissions"),
        "my-submissions-overwritten": _("My overwritten submissions"),
        "user-submissions-overwritten": _("Overwritten submissions"),
    }.get(filter)

    return (filter_name, extra)
